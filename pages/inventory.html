<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Inventory — TallySync Manager</title>
  <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
<div id="page-content">

  <div class="page-header">
    <h1>Inventory</h1>
    <div class="page-actions">
      <button class="btn btn-outline btn-sm" id="btn-export-inv">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
        Export CSV
      </button>
      <button class="btn btn-outline btn-sm" id="btn-refresh-inv">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>
        Sync Now
      </button>
    </div>
  </div>

  <!-- Stats -->
  <div class="kpi-grid" style="grid-template-columns:repeat(4,1fr);margin-bottom:1rem;">
    <div class="kpi-card"><div class="kpi-label">Total Items</div><div class="kpi-value" id="inv-total">—</div></div>
    <div class="kpi-card danger"><div class="kpi-label">Low Stock</div><div class="kpi-value" id="inv-lowstock">—</div></div>
    <div class="kpi-card success"><div class="kpi-label">Inventory Value</div><div class="kpi-value text-sm" id="inv-value">—</div></div>
    <div class="kpi-card"><div class="kpi-label">Groups</div><div class="kpi-value" id="inv-groups">—</div></div>
  </div>

  <!-- Filters -->
  <div class="filter-bar">
    <div class="search-wrap">
      <span class="search-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
      </span>
      <input type="text" id="inv-search" class="form-control" placeholder="Search items…">
    </div>
    <select id="inv-group-filter" class="filter-select">
      <option value="">All Groups</option>
    </select>
    <label class="flex items-center gap-2 text-sm" style="cursor:pointer;">
      <input type="checkbox" id="inv-low-stock-filter" style="width:1rem;height:1rem;cursor:pointer;">
      Low stock only
    </label>
  </div>

  <!-- Table -->
  <div class="table-wrap">
    <table>
      <thead><tr>
        <th>Item Name</th><th>Alias</th><th>Group</th><th>UOM</th>
        <th class="text-right">Closing Qty</th>
        <th class="text-right">Value (₹)</th>
        <th class="text-right">Rate (₹)</th>
        <th class="text-right">Reorder Level</th>
        <th>Status</th>
      </tr></thead>
      <tbody id="inv-table-body"><tr><td colspan="9" style="padding:2.5rem;text-align:center;"><span class="spinner"></span></td></tr></tbody>
    </table>
  </div>

</div>

<!-- Reorder Level Modal -->
<div class="modal-overlay" id="reorder-modal">
  <div class="modal">
    <div class="modal-header">
      <div>
        <div class="modal-title">Set Reorder Level</div>
        <div class="modal-desc">Alert when stock drops below this quantity</div>
      </div>
      <button class="btn-icon" onclick="closeModal('reorder-modal')">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <p id="reorder-item-name" class="fw-600" style="margin-bottom:1rem;"></p>
      <div class="form-group">
        <label class="form-label">Reorder Level (Qty)</label>
        <input type="number" id="reorder-level-input" class="form-control" min="0" step="0.01" placeholder="0.00">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="closeModal('reorder-modal')">Cancel</button>
      <button class="btn btn-primary" id="btn-save-reorder">Save</button>
    </div>
  </div>
</div>

<script src="../assets/js/config.js"></script>
<script src="../assets/js/api.js"></script>
<script src="../assets/js/utils.js"></script>
<script src="../assets/js/sync.js"></script>
<script src="../assets/js/layout.js"></script>
<script src="../assets/js/pages/inventory.js"></script>
<script>
  injectLayout('Inventory');
  initInventory();
  window.addEventListener('company:changed', initInventory);
  window.addEventListener('sync:complete', initInventory);
</script>
</body>
</html>
